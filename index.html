<head>    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.3.3/dist/leaflet.js" ></script>
       <script language="javascript">
       
      
    function init() {
      var KML;
      var url = 'https://www.google.com/maps/d/kml?forcekml=1&mid=1UAaEimj8pXvtvITpOBDVFt_GKvpe8lkN&lid=FyEYgVsoA6U';
var method = 'GET';
fetch(url).then(function(response) {
    return response.text();
}).then(function(responseText) {
    KML = responseText;
  //console.log(KML);
  /* You can safely render here */
   /* var createCORSRequest = function(method, url) {
  var xhr = new XMLHttpRequest();
 
    if ("withCredentials" in xhr) {
    // Most browsers.
    xhr.open(method, url, true);
  } else if (typeof XDomainRequest != "undefined") {
    // IE8 & IE9
    xhr = new XDomainRequest();
    xhr.open(method, url);
  } else {
    // CORS not supported.
    xhr = null;
  }
  return xhr;
};

var url = 'https://www.google.com/maps/d/kml?forcekml=1&mid=1UAaEimj8pXvtvITpOBDVFt_GKvpe8lkN&lid=FyEYgVsoA6U';
var method = 'GET';
var xhr = createCORSRequest(method, url);

xhr.onload = function() {
 //var responseText = xhr.responseText;
 //KML = responseText;
     KML=xhr.responseText;
      console.log("responseText: "+KML);
 // process the response.
};

xhr.onerror = function() {
  console.log('There was an error!');
};

xhr.send();*/

    // read text from URL location
    /*var request = new XMLHttpRequest();
    request.open('GET', 'http://www.google.com/maps/d/kml?forcekml=1&mid=1UAaEimj8pXvtvITpOBDVFt_GKvpe8lkN&lid=FyEYgVsoA6U', true);
    request.send(null);
    alert(request.responseText);
    var KML=request.responseText;
*/
         var map = new L.Map('map');                       
                
         L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://openstreetmap.org/">OpenStreetMap</a> contributors',
            maxZoom: 18
         }).addTo(map);
         map.attributionControl.setPrefix(''); // Don't show the 'Powered by Leaflet' text.

         var mitte = new L.LatLng(10,0); 
         map.setView(mitte, 1.5);

         
         // Define an array. This could be done in a seperate js file.
         // This tidy formatted section could even be generated by a server-side script
         // or fetched seperately as a jsonp request.
         var markers = [
         ];
         
  var dataset= KML.replace(/(\r\n|\n|\r)/gm,"");
  var coordlist=dataset.split("<Placemark>")
  for (var i=1;i<coordlist.length;i++)
  {
  var e4=coordlist[i].split("<description>")[1].split("</description>")[0].replace("]]>","").replace("<![CDATA[","")
  var e3=coordlist[i].split("<name>")[1].split("</name>")[0]
  var e2=parseFloat(coordlist[i].split("<coordinates>")[1].split("</coordinates>")[0].split(",")[0].replace(/ /g,""));
  var e1=parseFloat(coordlist[i].split("<coordinates>")[1].split("</coordinates>")[0].split(",")[1]);
  markers.push([e2,e1,"<b>"+e3+"</b><br>"+e4]);
  }
  
  
      
  //console.log(markers)
/*
for (var i=1;i<tabelle.rows.length;i++)
{
list=tabelle.getElementsByTagName("TR")[i].getElementsByTagName("TD")[0].getElementsByTagName("A")[0].innerHTML;
e3=tabelle.getElementsByTagName("TR")[i].getElementsByTagName("TD")[1].innerHTML;
e4=tabelle.getElementsByTagName("TR")[i].getElementsByTagName("TD")[4].innerHTML;
e5=tabelle.getElementsByTagName("TR")[i].getElementsByTagName("TD")[7].innerHTML;
e1=parseFloat(list.split(",")[0]);
e2=parseFloat(list.split(",")[1]);
markers.push([e2,e1,e3+"<br>"+e4+"<br>"+e5]);
}
*/
         //Loop through the markers array
         for (var i=0; i<markers.length; i++) {
           
            var lon = markers[i][0];
            var lat = markers[i][1];
            var popupText = markers[i][2];
            
             var markerLocation = new L.LatLng(lat, lon);
             var marker = new L.Marker(markerLocation);
             map.addLayer(marker);

             marker.bindPopup(popupText);

         }
         function changeMarkerImage(a) {
        markerimglist=document.getElementsByClassName("leaflet-marker-icon ");
          for (var i=0;i<markerimglist.length;i++)
          {
markerimglist[i].src=a;
}
    }
  changeMarkerImage("https://cdn.discordapp.com/emojis/468667452276867082.png");
})
      
      }
   </script>
   <style>.leaflet-marker-icon{
  width:auto !important;
}</style>
</head>
<body onload="javascript:init();"><div id="map" style="height: 450px"></div>
</body>
